<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.2</version>
    <templates>
        <template>
            <template>Template Domain CN Expiry</template>
            <name>Template Domain CN Expiry</name>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
            </groups>
            <macros>
                <macro>
                    <macro>{$DOMAIN_NAME}</macro>
                    <value>comunidade.cn</value>
                    <description>O nome do domínio a ser verificado.</description>
                </macro>
            </macros>
            <items>
                <item>
                    <name>Dias para expiração do domínio {$DOMAIN_NAME}</name>
                    <type>ZABBIX_AGENT_ACTIVE</type>
                    <key>check_domain_expiry.sh["{$DOMAIN_NAME}"]</key>
                    <delay>1d</delay>
                    <history>90d</history>
                    <trends>365d</trends>
                    <value_type>INTEGER</value_type>
                    <units>dias</units>
                    <description>Verifica o número de dias restantes até a expiração do domínio.</description>
                </item>
            </items>
            <triggers>
			<trigger>
				<name>O domínio {$DOMAIN_NAME} expira em menos de 90 dias ({ITEM.LASTVALUE} dias restantes)</name>
				<expression>last(/Template Domain CN Expiry/domain.expiry.days[{$DOMAIN_NAME}])<90 and last(/Template Domain CN Expiry/domain.expiry.days[{$DOMAIN_NAME}])>=0</expression>
				<priority>HIGH</priority>
				<description>O domínio {$DOMAIN_NAME} irá expirar em breve. Por favor, renove-o o mais rápido possível.</description>
			</trigger>
            </triggers>
        </template>
    </templates>
</zabbix_export>